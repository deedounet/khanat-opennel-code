FILE(GLOB SRC *.cpp time_weather_season/*.cpp time_weather_season/*.h)
FILE(GLOB PRIV_H *.h)
#FILE(GLOB PUB_H ../../include/nel/georges/*.h)

SOURCE_GROUP(headers FILES ${PRIV_H} ${PUB_H})

# Filter out the source files not actually compiled.
LIST(REMOVE_ITEM SRC ${CMAKE_CURRENT_SOURCE_DIR}/enum_template.cpp)
LIST(REMOVE_ITEM PRIV_H ${CMAKE_CURRENT_SOURCE_DIR}/enum_template.h)

DECORATE_NEL_LIB("game_share")
SET(GAME_SHARE_LIB ${LIBNAME})
DECORATE_NEL_LIB("nelmisc")
SET(NLMISC_LIB ${LIBNAME})


IF(NOT WIN32)
  ADD_LIBRARY(${GAME_SHARE_LIB} SHARED ${SRC})
ELSE(NOT WIN32)
  ADD_LIBRARY(${GAME_SHARE_LIB} STATIC ${SRC})
ENDIF(NOT WIN32)

INCLUDE_DIRECTORIES(${LIBXML2_INCLUDE_DIR} ${NELMISC_INCLUDE_DIRS} ${CMAKE_CURRENT_SOURCE_DIR})
TARGET_LINK_LIBRARIES(${GAME_SHARE_LIB} ${NELMISC_LIBRARY})
SET_TARGET_PROPERTIES(${GAME_SHARE_LIB} PROPERTIES VERSION ${NL_VERSION})

IF(WIN32)
#  SET_TARGET_PROPERTIES(${GAME_SHARE_LIB} PROPERTIES COMPILE_FLAGS "/Yustdgeorges.h")
#  SET_SOURCE_FILES_PROPERTIES(stdgeorges.cpp PROPERTIES COMPILE_FLAGS "/Ycstdgeorges.h")
  SET_TARGET_PROPERTIES(${GAME_SHARE_LIB} PROPERTIES LINK_FLAGS "/NODEFAULTLIB:libcmt")
ENDIF(WIN32)

ADD_DEFINITIONS(${LIBXML2_DEFINITIONS})

INSTALL(TARGETS ${GAME_SHARE_LIB} LIBRARY DESTINATION lib ARCHIVE DESTINATION lib COMPONENT libraries)
